{"ast":null,"code":"import { toChecksumAddress } from 'web3-utils';\nimport DEFAULT_TOKEN_LIST from '@uniswap/default-token-list'; // import {DEFAULT_LIST_OF_LISTS} from '../../constants/lists'\n// const DEFAULT_TOKEN_LIST = DEFAULT_LIST_OF_LISTS\n\nimport { ChainId, Token } from '@uniswap/sdk';\nimport { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport sortByListPriority from 'utils/listSort';\n\n/**\n * Token instances created from token info.\n */\nexport class WrappedTokenInfo extends Token {\n  constructor(tokenInfo, tags) {\n    super(tokenInfo.chainId, toChecksumAddress(tokenInfo.address), tokenInfo.decimals, tokenInfo.symbol, tokenInfo.name);\n    this.tokenInfo = void 0;\n    this.tags = void 0;\n    this.tokenInfo = tokenInfo;\n    this.tags = tags;\n  }\n\n  get logoURI() {\n    return this.tokenInfo.logoURI;\n  }\n\n}\n\n/**\n * An empty result, useful as a default.\n */\nconst EMPTY_LIST = {\n  [ChainId.KOVAN]: {},\n  [ChainId.RINKEBY]: {},\n  [ChainId.ROPSTEN]: {},\n  [ChainId.G√ñRLI]: {},\n  [ChainId.MAINNET]: {},\n  [ChainId.FORNAX]: {}\n};\nconst listCache = typeof WeakMap !== 'undefined' ? new WeakMap() : null;\nexport function listToTokenMap(list) {\n  const result = listCache === null || listCache === void 0 ? void 0 : listCache.get(list);\n  if (result) return result;\n  console.log('list.tokens', list.tokens);\n  const map = list.tokens.reduce((tokenMap, tokenInfo) => {\n    var _tokenInfo$tags$map$f, _tokenInfo$tags, _tokenInfo$tags$map;\n\n    console.log('inside=>', tokenMap, 'tokenInfo = >', tokenInfo);\n    const tags = (_tokenInfo$tags$map$f = (_tokenInfo$tags = tokenInfo.tags) === null || _tokenInfo$tags === void 0 ? void 0 : (_tokenInfo$tags$map = _tokenInfo$tags.map(tagId => {\n      var _list$tags;\n\n      if (!((_list$tags = list.tags) === null || _list$tags === void 0 ? void 0 : _list$tags[tagId])) return undefined;\n      return { ...list.tags[tagId],\n        id: tagId\n      };\n    })) === null || _tokenInfo$tags$map === void 0 ? void 0 : _tokenInfo$tags$map.filter(x => Boolean(x))) !== null && _tokenInfo$tags$map$f !== void 0 ? _tokenInfo$tags$map$f : [];\n    const token = new WrappedTokenInfo(tokenInfo, tags);\n    if (tokenMap[token.chainId][token.address] !== undefined) throw Error('Duplicate tokens.');\n    return { ...tokenMap,\n      [token.chainId]: { ...tokenMap[token.chainId],\n        [token.address]: {\n          token,\n          list: list\n        }\n      }\n    };\n  }, { ...EMPTY_LIST\n  });\n  listCache === null || listCache === void 0 ? void 0 : listCache.set(list, map);\n  return map;\n}\nexport function useAllLists() {\n  return useSelector(state => state.lists.byUrl);\n}\n\nfunction combineMaps(map1, map2) {\n  return {\n    1: { ...map1[1],\n      ...map2[1]\n    },\n    3: { ...map1[3],\n      ...map2[3]\n    },\n    4: { ...map1[4],\n      ...map2[4]\n    },\n    13937: { ...map1[13937],\n      ...map2[13937]\n    },\n    5: { ...map1[5],\n      ...map2[5]\n    },\n    42: { ...map1[42],\n      ...map2[42]\n    }\n  };\n} // merge tokens contained within lists from urls\n\n\nfunction useCombinedTokenMapFromUrls(urls) {\n  const lists = useAllLists(); // console.log('lists = > ', lists)\n\n  return useMemo(() => {\n    if (!urls) return EMPTY_LIST;\n    return urls.slice() // sort by priority so top priority goes last\n    .sort(sortByListPriority).reduce((allTokens, currentUrl) => {\n      var _lists$currentUrl;\n\n      const current = (_lists$currentUrl = lists[currentUrl]) === null || _lists$currentUrl === void 0 ? void 0 : _lists$currentUrl.current;\n      if (!current) return allTokens;\n\n      try {\n        const newTokens = Object.assign(listToTokenMap(current));\n        return combineMaps(allTokens, newTokens);\n      } catch (error) {\n        console.error('Could not show token list due to error', error);\n        return allTokens;\n      }\n    }, EMPTY_LIST);\n  }, [lists, urls]);\n} // filter out unsupported lists\n\n\nexport function useActiveListUrls() {\n  return useSelector(state => state.lists.activeListUrls);\n}\nexport function useInactiveListUrls() {\n  const lists = useAllLists();\n  const allActiveListUrls = useActiveListUrls();\n  return Object.keys(lists).filter(url => !(allActiveListUrls === null || allActiveListUrls === void 0 ? void 0 : allActiveListUrls.includes(url)));\n} // get all the tokens from active lists, combine with local default tokens\n\nexport function useCombinedActiveList() {\n  const activeListUrls = useActiveListUrls(); // console.log('üíª activeListUrls:', activeListUrls)\n\n  const activeTokens = useCombinedTokenMapFromUrls(activeListUrls); // console.log('ü™ô activeTokens', activeTokens)\n  // console.log('‚ùå DEFAULT_TOKEN_LIST', DEFAULT_TOKEN_LIST)\n\n  const defaultTokenMap = listToTokenMap(DEFAULT_TOKEN_LIST);\n  return combineMaps(activeTokens, defaultTokenMap);\n} // all tokens from inactive lists\n\nexport function useCombinedInactiveList() {\n  const allInactiveListUrls = useInactiveListUrls();\n  return useCombinedTokenMapFromUrls(allInactiveListUrls);\n} // used to hide warnings on import for default tokens\n\nexport function useDefaultTokenList() {\n  return listToTokenMap(DEFAULT_TOKEN_LIST);\n}\nexport function useIsListActive(url) {\n  const activeListUrls = useActiveListUrls();\n  return Boolean(activeListUrls === null || activeListUrls === void 0 ? void 0 : activeListUrls.includes(url));\n}","map":{"version":3,"names":["toChecksumAddress","DEFAULT_TOKEN_LIST","ChainId","Token","useMemo","useSelector","sortByListPriority","WrappedTokenInfo","constructor","tokenInfo","tags","chainId","address","decimals","symbol","name","logoURI","EMPTY_LIST","KOVAN","RINKEBY","ROPSTEN","G√ñRLI","MAINNET","FORNAX","listCache","WeakMap","listToTokenMap","list","result","get","console","log","tokens","map","reduce","tokenMap","tagId","undefined","id","filter","x","Boolean","token","Error","set","useAllLists","state","lists","byUrl","combineMaps","map1","map2","useCombinedTokenMapFromUrls","urls","slice","sort","allTokens","currentUrl","current","newTokens","Object","assign","error","useActiveListUrls","activeListUrls","useInactiveListUrls","allActiveListUrls","keys","url","includes","useCombinedActiveList","activeTokens","defaultTokenMap","useCombinedInactiveList","allInactiveListUrls","useDefaultTokenList","useIsListActive"],"sources":["/Users/rakoon/Documents/Projects/fornax/frxswap/interface/src/state/lists/hooks.ts"],"sourcesContent":["import { toChecksumAddress } from 'web3-utils';\nimport DEFAULT_TOKEN_LIST from '@uniswap/default-token-list';\n// import {DEFAULT_LIST_OF_LISTS} from '../../constants/lists'\n// const DEFAULT_TOKEN_LIST = DEFAULT_LIST_OF_LISTS\nimport { ChainId, Token } from '@uniswap/sdk';\nimport { Tags, TokenInfo, TokenList } from '@uniswap/token-lists';\nimport { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport { AppState } from '../index';\nimport sortByListPriority from 'utils/listSort';\n\ntype TagDetails = Tags[keyof Tags];\nexport interface TagInfo extends TagDetails {\n  id: string;\n}\n\n/**\n * Token instances created from token info.\n */\nexport class WrappedTokenInfo extends Token {\n  public readonly tokenInfo: TokenInfo;\n  public readonly tags: TagInfo[];\n  constructor(tokenInfo: TokenInfo, tags: TagInfo[]) {\n    super(\n      tokenInfo.chainId,\n      toChecksumAddress(tokenInfo.address),\n      tokenInfo.decimals,\n      tokenInfo.symbol,\n      tokenInfo.name\n    );\n    this.tokenInfo = tokenInfo;\n    this.tags = tags;\n  }\n  public get logoURI(): string | undefined {\n    return this.tokenInfo.logoURI;\n  }\n}\n\nexport type TokenAddressMap = Readonly<\n  { [chainId in ChainId]: Readonly<{ [tokenAddress: string]: { token: WrappedTokenInfo; list: TokenList } }> }\n>;\n\n/**\n * An empty result, useful as a default.\n */\nconst EMPTY_LIST: TokenAddressMap = {\n  [ChainId.KOVAN]: {},\n  [ChainId.RINKEBY]: {},\n  [ChainId.ROPSTEN]: {},\n  [ChainId.G√ñRLI]: {},\n  [ChainId.MAINNET]: {},\n  [ChainId.FORNAX]: {},\n};\n\nconst listCache: WeakMap<TokenList, TokenAddressMap> | null =\n  typeof WeakMap !== 'undefined' ? new WeakMap<TokenList, TokenAddressMap>() : null;\n\nexport function listToTokenMap(list: TokenList): TokenAddressMap {\n  const result = listCache?.get(list);\n  if (result) return result;\n  console.log('list.tokens', list.tokens)\n  const map = list.tokens.reduce<TokenAddressMap>(\n    (tokenMap, tokenInfo) => {\n      console.log('inside=>',tokenMap, 'tokenInfo = >',tokenInfo)\n\n      const tags: TagInfo[] =\n        tokenInfo.tags\n          ?.map((tagId) => {\n            if (!list.tags?.[tagId]) return undefined;\n            return { ...list.tags[tagId], id: tagId };\n          })\n          ?.filter((x): x is TagInfo => Boolean(x)) ?? [];\n      const token = new WrappedTokenInfo(tokenInfo, tags);\n      if (tokenMap[token.chainId][token.address] !== undefined) throw Error('Duplicate tokens.');\n      return {\n        ...tokenMap,\n        [token.chainId]: {\n          ...tokenMap[token.chainId],\n          [token.address]: {\n            token,\n            list: list,\n          },\n        },\n      };\n    },\n    { ...EMPTY_LIST }\n  );\n  listCache?.set(list, map);\n  return map;\n}\n\nexport function useAllLists(): {\n  readonly [url: string]: {\n    readonly current: TokenList | null;\n    readonly pendingUpdate: TokenList | null;\n    readonly loadingRequestId: string | null;\n    readonly error: string | null;\n  };\n} {\n  return useSelector<AppState, AppState['lists']['byUrl']>((state) => state.lists.byUrl);\n}\n\nfunction combineMaps(map1: TokenAddressMap, map2: TokenAddressMap): TokenAddressMap {\n  return {\n    1: { ...map1[1], ...map2[1] },\n    3: { ...map1[3], ...map2[3] },\n    4: { ...map1[4], ...map2[4] },\n    13937: { ...map1[13937], ...map2[13937] },\n    5: { ...map1[5], ...map2[5] },\n    42: { ...map1[42], ...map2[42] },\n  };\n}\n\n// merge tokens contained within lists from urls\nfunction useCombinedTokenMapFromUrls(urls: string[] | undefined): TokenAddressMap {\n  const lists = useAllLists();\n  // console.log('lists = > ', lists)\n\n  return useMemo(() => {\n    if (!urls) return EMPTY_LIST;\n\n    return (\n      urls\n        .slice()\n        // sort by priority so top priority goes last\n        .sort(sortByListPriority)\n        .reduce((allTokens, currentUrl) => {\n          const current = lists[currentUrl]?.current;\n          if (!current) return allTokens;\n          try {\n            const newTokens = Object.assign(listToTokenMap(current));\n            return combineMaps(allTokens, newTokens);\n          } catch (error) {\n            console.error('Could not show token list due to error', error);\n            return allTokens;\n          }\n        }, EMPTY_LIST)\n    );\n  }, [lists, urls]);\n}\n\n// filter out unsupported lists\nexport function useActiveListUrls(): string[] | undefined {\n  return useSelector<AppState, AppState['lists']['activeListUrls']>((state) => state.lists.activeListUrls);\n}\n\nexport function useInactiveListUrls(): string[] {\n  const lists = useAllLists();\n  const allActiveListUrls = useActiveListUrls();\n  return Object.keys(lists).filter((url) => !allActiveListUrls?.includes(url));\n}\n\n// get all the tokens from active lists, combine with local default tokens\nexport function useCombinedActiveList(): TokenAddressMap {\n  const activeListUrls = useActiveListUrls();\n  // console.log('üíª activeListUrls:', activeListUrls)\n  const activeTokens = useCombinedTokenMapFromUrls(activeListUrls);\n  // console.log('ü™ô activeTokens', activeTokens)\n  // console.log('‚ùå DEFAULT_TOKEN_LIST', DEFAULT_TOKEN_LIST)\n  const defaultTokenMap = listToTokenMap(DEFAULT_TOKEN_LIST);\n  return combineMaps(activeTokens, defaultTokenMap);\n}\n\n// all tokens from inactive lists\nexport function useCombinedInactiveList(): TokenAddressMap {\n  const allInactiveListUrls: string[] = useInactiveListUrls();\n  return useCombinedTokenMapFromUrls(allInactiveListUrls);\n}\n\n// used to hide warnings on import for default tokens\nexport function useDefaultTokenList(): TokenAddressMap {\n  return listToTokenMap(DEFAULT_TOKEN_LIST);\n}\n\nexport function useIsListActive(url: string): boolean {\n  const activeListUrls = useActiveListUrls();\n  return Boolean(activeListUrls?.includes(url));\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}